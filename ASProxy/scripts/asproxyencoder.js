// ASProxy Dynamic Encoder
// ASProxy encoder for dynamically created objects //
// Last update: 2010-08-21 coded by Salar.Kh //
// Licende: MPL 1.1 License agreement.
function __UrlEncoder(e,t,n,r){if(_ASProxy.IsClientSideUrl(e)||_ASProxy.IsSelfBookmarkUrl(e))return e;if(_ASProxy.IsEncodedByASProxy(e))return e;if(n!=true)e=_ASProxy.CorrectLocalUrlToOrginal(e);if(_ASProxy.IsVirtualUrl(e))e=_ASProxy.JoinUrls(e,_reqInfo.pageUrl,_reqInfo.pagePath,_reqInfo.rootUrl);var i;if(t==ENC_Images)i=_ASProxy.Pages.pgImages;else if(t==ENC_Any)i=_ASProxy.Pages.pgGetAny;else if(t==ENC_Frames)i=_ASProxy.Pages.pgGetHtml;else i=_reqInfo.ASProxyPageName;if(_ASProxy.Debug_UseAbsoluteUrl)i=_reqInfo.ASProxyPath+i;i+="?dec="+(_userConfig.EncodeUrl+0)+"&url=";var s;var o;s=_ASProxy.ReturnBookmarkPart(e);if(s!="")e=_ASProxy.RemoveBookmarkPart(e);o=i;if(_userConfig.EncodeUrl)o+=_ASProxy.B64UnknownerAdd(_Base64_encode(e));else o+=escape(e);if(r!=null)o+="&"+r;o+=s;return o}function __CookieGet(e){return _ASProxy.GetDocumentCookie()}function __CookieSet(e){return _ASProxy.SetDocumentCookie(e)}function _ArrayAdd(e,t,n){e[t]=n}if(typeof _ASProxyLoaded!="undefined")_ASProxyLoaded=false;else _ASProxyLoaded=true;_ASProxy={Debug_UseAbsoluteUrl:false,DynamicEncoders:true,TraceCookies:false,LogEnabled:false,ServerSideParser:false,Activities:{},Pages:{pgGetAny:"getany.ashx",pgGetHtml:"gethtml.ashx",pgGetJS:"getjs.ashx",pgImages:"images.ashx",pgDownload:"download.ashx",pgAuthorization:"authorization.aspx",pgAjax:"ajax.ashx",pgParser:"parser.ashx"},ClientSideUrls:["mailto:","file://","javascript:","vbscript:","jscript:","vbs:","ymsgr:","data:"],NonVirtualUrls:["http://","https://","mailto:","ftp://","file://","telnet://","news://","nntp://","ldap://","ymsgr:","javascript:","vbscript:","jscript:","vbs:","data:"]};if(typeof _reqInfo=="undefined")_reqInfo={ASProxyPageName:"surf.aspx"};_ASProxy.EncodedUrls=[_reqInfo.ASProxyPageName+"?dec=",_ASProxy.Pages.pgAjax+"?dec=",_ASProxy.Pages.pgGetHtml+"?dec=",_ASProxy.Pages.pgImages+"?dec=",_ASProxy.Pages.pgGetJS+"?dec=",_ASProxy.Pages.pgDownload+"?dec=",_ASProxy.Pages.pgAuthorization+"?dec=",_ASProxy.Pages.pgGetAny+"?dec="];document.OriginalWrite=document.write;document.OriginalWriteLn=document.writeln;window.OriginalOpen=window.open;window.LocationReplace=window.location.replace;window.LocationAssign=window.location.assign;window.LocationReload=window.location.reload;window.OriginalEval=window.eval;ENC_Page=0;ENC_Images=1;ENC_Any=2;ENC_Frames=3;_ASProxy.JoinUrls=function(e,t,n,r){if(typeof e!="string"||e.length==0)return t;if(n.lastIndexOf("/")!=n.length-1)n+="/";if(r.lastIndexOf("/")!=r.length-1)r+="/";var i;if(e.indexOf("/",0)==0)i=r+"."+e;else i=n+e;return i};_ASProxy.IsClientSideUrl=function(e){if(typeof e!="string")return false;e=e.toLowerCase();for(i=0;i<_ASProxy.ClientSideUrls.length;i++){if(_ASProxy.StrStartsWith(e,_ASProxy.ClientSideUrls[i]))return true}return false};_ASProxy.IsVirtualUrl=function(e){if(typeof e!="string")return true;e=e.toLowerCase();for(i=0;i<_ASProxy.NonVirtualUrls.length;i++){if(_ASProxy.StrStartsWith(e,_ASProxy.NonVirtualUrls[i]))return false}return true};_ASProxy.IsSelfBookmarkUrl=function(e){if(typeof e!="string")return false;if(_ASProxy.StrStartsWith(e,"#"))return true;e=e.toLowerCase();var t=window.location.href.toLowerCase()+"#";if(e.indexOf(t,0)==0)return true;return false};_ASProxy.ReturnBookmarkPart=function(e){if(typeof e!="string")return"";var t=e.indexOf("#",0);if(t!=-1){e=e.substring(t,e.length);return e}return""};_ASProxy.RemoveBookmarkPart=function(e){if(typeof e!="string")return null;var t;var n=e.indexOf("#",0);if(n!=-1){e=e.substring(0,n);return e}return e};_ASProxy.CorrectLocalUrlToOrginalCheck=function(e){if(_ASProxy.IsClientSideUrl(e)||_ASProxy.IsSelfBookmarkUrl(e))return e;return _ASProxy.CorrectLocalUrlToOrginal(e)};_ASProxy.CorrectLocalUrlToOrginal=function(e){if(typeof e!="string")return null;var t=e.toLowerCase();var n=_reqInfo.ASProxyRoot.toLowerCase();var r=_reqInfo.ASProxyPath.toLowerCase();var i=_reqInfo.ASProxyPageName.toLowerCase();var s=_reqInfo.pageUrlNoQuery;var o=false;var u=t.indexOf(i,0);var a=i.length;if(u==-1){u=t.indexOf(r,0);a=r.length;s=_reqInfo.pagePath;o=true}if(u==-1){u=t.indexOf(n,0);a=n.length;s=_reqInfo.rootUrl;o=true}if(s.substr(s.length-1,1)=="/"){s=s.substr(0,s.length-1);o=true}if(u==0){var f=e.substr(a,e.length);var l="/";if(o==false||f.substr(0,1)=="/")l="";return s+l+f}else return e};_ASProxy.B64UnknownerAdd=function(e){if(typeof e!="string")return _reqInfo.UrlUnknowner;var t=_reqInfo.UrlUnknowner.toLowerCase();var n=e.toLowerCase();var r=!_ASProxy.StrEndsWith(n,t);if(r)return e+_reqInfo.UrlUnknowner;else return e};_ASProxy.B64UnknownerRemove=function(e){if(typeof e!="string")return e;var t=_reqInfo.UrlUnknowner.toLowerCase();var n=e.toLowerCase();var r=n.indexOf(t);if(r>-1)return e.substring(0,r);else return e};_ASProxy.HasB64Unknowner=function(e){if(typeof e!="string")return e;var t=_reqInfo.UrlUnknowner.toLowerCase();var n=e.toLowerCase();return _ASProxy.StrEndsWith(n,t)};_ASProxy.Log=function(){if(_ASProxy.LogEnabled&&typeof console!="undefined"){try{console.debug("ASProxy log:");var e="";for(var t=0;t<arguments.length;t++){e+=arguments[t]+"\n"}console.debug(e)}catch(n){}}};_ASProxy.IsEncodedByASProxy=function(e){if(typeof e!="string")return false;e=e.toLowerCase();var t=_reqInfo.ASProxyPath.toLowerCase();for(i=0;i<_ASProxy.EncodedUrls.length;i++){if(_ASProxy.StrStartsWith(e,_ASProxy.EncodedUrls[i]))return true;else if(_ASProxy.StrStartsWith(e,t+_ASProxy.EncodedUrls[i]))return true}return false};_ASProxy.GetBookmarkOnlyForCurrentPage=function(e){if(typeof e!="string")return e;var t=document.location.href.toLowerCase();var n=e.toLowerCase();var r=e.indexOf("#",0);if(r!=-1){var i=n.indexOf(t,0);if(i==-1)return e;else return _reqInfo.pageUrl+e.substring(r,e.length)}return e};_ASProxy.AttachEvent=function(e,t,n,r){try{if(e==null){return false}if(e.addEventListener){e.addEventListener(t,n,r);return true}else if(e.attachEvent){var i=e.attachEvent("on"+t,n);return i}else{try{e["on"+t]=n}catch(s){_ASProxy.Log('AttachEvent"on"',s)}}}catch(s){_ASProxy.Log("AttachEvent",s)}};_ASProxy.DetachEvent=function(e,t,n,r){try{if(e==null){return false}if(e.removeEventListener){e.removeEventListener(t,n,r);return true}else if(e.detachEvent){var i=e.detachEvent("on"+t,n);return i}else{try{delete e["on"+t]}catch(s){_ASProxy.Log('DetachEvent"on"',s)}}}catch(s){_ASProxy.Log("DetachEvent",s)}};_ASProxy.StrTrimLeft=function(e){return e.replace(/^\s*/,"")};_ASProxy.StrTrimRight=function(e){return e.replace(/\s*$/,"")};_ASProxy.StrTrim=function(e){return e.replace(/^\s+|\s+$/g,"")};_ASProxy.StrStartsWith=function(e,t){if(e.length==0||e.length<t.length){return false}return e.substr(0,t.length)==t};_ASProxy.StrEndsWith=function(e,t){if(e.length==0||e.length<t.length){return false}return e.substr(e.length-t.length)==t};_ASProxy.GetUrlParamValue=function(e,t){try{if(t==null||e==null)return"";e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n="[\\?&]"+e+"=([^&#]*)";var r=new RegExp(n);var i=r.exec(t);if(i==null)return"";return i[1]}catch(s){_ASProxy.Log("GetUrlParamValue failed!",s);return""}};_ASProxy.DecodeASProxyUrl=function(e){if(typeof e!="string")return e;if(!_ASProxy.IsEncodedByASProxy(e))return e;var t=_ASProxy.GetUrlParamValue("url",e)+"";if(t=="")return e;if(_ASProxy.HasB64Unknowner(e))return _Base64_decode(_ASProxy.B64UnknownerRemove(t));else return unescape(t)};_ASProxy.Enc={};_ASProxy.Enc.EncodeElements=function(e,t,n,r,i,s,o,u){var a=0;var f;for(a=0;a<e.length;a++){f=e[a];var l=f.attributes[t];var c=f[t];if(l!=null)l=l.value;else l=c;if(_ASProxy.IsEncodedByASProxy(l)==false){var h=false;if(i!=null&&s!=null){var p=f.attributes[i];if(p!=null)p=p.value;else p=f[i];if(p!=null){if(p.toLowerCase()!=s.toLowerCase())continue}}var d=f.attributes["asproxydone"];if(d==null||d.value!="1"&&d.value!="2"){h=true}else if(d.value=="1"){var v=f.attributes["encodedurl"];if(v==null){_ASProxy.CallOrgSetAttrib(f,"encodedurl",l);if(n==3&&o){_ASProxy.CallOrgSetAttrib(f,o,u)}h=true}else v=v.value;if(l!=v){if(l==window.location)continue;else h=true}}if(h){var m=_ASProxy.CorrectLocalUrlToOrginalCheck(l);c=_ASProxy.CorrectLocalUrlToOrginalCheck(c);_ASProxy.CallOrgSetAttrib(f,"asproxydone","1");_ASProxy.CallOrgSetAttrib(f,"originalurl",_ASProxy.GetBookmarkOnlyForCurrentPage(c));if(n==3&&o){_ASProxy.CallOrgSetAttrib(f,o,u)}if(r&&_userConfig.OrginalUrl){if(typeof ORG_IN_!="undefined")_ASProxy.AttachEvent(f,"mouseover",function(){ORG_IN_(this)});if(typeof ORG_OUT_!="undefined")_ASProxy.AttachEvent(f,"mouseout",function(){ORG_OUT_()})}if(l==window.location&&m==l)continue;else m=__UrlEncoder(m,n,true,null);_ASProxy.CallOrgSetAttrib(f,t,m);f[t]=m;_ASProxy.CallOrgSetAttrib(f,"encodedurl",m)}}}};_ASProxy.Enc.EncodeForms=function(){if(_userConfig.Forms!=true)return;var e=0;var t;for(e=0;e<document.forms.length;e++){t=document.forms.item(e);var n=t.attributes["action"];if(n!=null)n=n.value;else n=t.action;if(_ASProxy.IsEncodedByASProxy(n)==false){var r=false;var i=t.attributes["asproxydone"];var s=t.method;if(i==null||i.value!="1"&&i.value!="2"){r=true}else if(i.value=="1"){var o=t.attributes["encodedurl"];if(o==null)o="";else o=o.value;s=t.attributes["methodorginal"];if(s==null)s=t.method;else s=s.value;var u=o.indexOf("://",0);if(u==-1){o=document.location.protocol+"//"+document.location.host+"/"+o}if(n!=o){r=true}}if(r){_ASProxy.CallOrgSetAttrib(t,"asproxydone","1");_ASProxy.CallOrgSetAttrib(t,"methodorginal",s);var a=__UrlEncoder(n,ENC_Page,false,"method="+s);_ASProxy.CallOrgSetAttrib(t,"action",a);_ASProxy.CallOrgSetAttrib(t,"encodedurl",a);t.method="POST"}}}if(_ASProxy.DynamicEncoders)window.setTimeout("_ASProxy.Enc.EncodeForms();",2e3)};_ASProxy.Enc.EncodeFrames=function(){if(_userConfig.Frames!=true)return;var e=document.documentElement.getElementsByTagName("iframe");try{_ASProxy.Enc.EncodeElements(e,"src",3,false,null,null,"onload","_ASProxy.Enc.EncodeFrames()")}catch(t){_ASProxy.Log("Enc.EncodeFrames",t)}if(_ASProxy.DynamicEncoders)window.setTimeout("_ASProxy.Enc.EncodeFrames();",5e3)};_ASProxy.Enc.EncodeLinks=function(){if(_userConfig.Links!=true)return;try{_ASProxy.Enc.EncodeElements(document.links,"href",0,true)}catch(e){_ASProxy.Log("Enc.EncodeLinks",e)}if(_ASProxy.DynamicEncoders)window.setTimeout("_ASProxy.Enc.EncodeLinks();",1e3)};_ASProxy.Enc.EncodeImages=function(){if(_userConfig.Images!=true)return;try{_ASProxy.Enc.EncodeElements(document.images,"src",1,true)}catch(e){_ASProxy.Log("Enc.EncodeImages",e)}if(_ASProxy.DynamicEncoders)window.setTimeout("_ASProxy.Enc.EncodeImages();",1e3)};_ASProxy.Enc.EncodeInputImages=function(){if(_userConfig.Images!=true)return;var e=document.documentElement.getElementsByTagName("input");try{_ASProxy.Enc.EncodeElements(e,"src",1,true,"type","image")}catch(t){_ASProxy.Log("Enc.EncodeInputImages",t)}if(_ASProxy.DynamicEncoders)window.setTimeout("_ASProxy.Enc.EncodeInputImages();",4e3)};_ASProxy.Enc.EncodeScriptSources=function(){var e=document.documentElement.getElementsByTagName("script");try{_ASProxy.Enc.EncodeElements(e,"src",2,false)}catch(t){_ASProxy.Log("Enc.EncodeScriptSources",t)}if(_ASProxy.DynamicEncoders)window.setTimeout("_ASProxy.Enc.EncodeScriptSources();",4e3)};_ASProxy.LocationObject=function(){this.search=_reqInfo.location.Search;this.href=_reqInfo.pageUrl;this.hash=window.location.hash!=null&&window.location.hash!=""?window.location.hash:_reqInfo.location.Hash;this.host=_reqInfo.location.Host;this.hostname=_reqInfo.location.Hostname;this.pathname=_reqInfo.location.Pathname;this.port=_reqInfo.location.Port;this.protocol=_reqInfo.location.Protocol;this.replace=window.LocationReplace;this.assign=window.LocationAssign;this.replace=_ASProxy.LocationReplace;this.assign=_ASProxy.LocationAssign;this.reload=_ASProxy.LocationReload;this.URL=_reqInfo.pageUrl;this.toString=function(){return _reqInfo.pageUrl};this.toLocaleString=function(){return _reqInfo.pageUrl};this.length=this.href.length;this.anchor=this.href.anchor;this.big=this.href.big;this.blink=this.href.blink;this.bold=this.href.bold;this.charAt=this.href.charAt;this.charCodeAt=this.href.charCodeAt;this.fixed=this.href.fixed;this.fontcolor=this.href.fontcolor;this.fontsize=this.href.fontsize;this.fromCharCode=this.href.fromCharCode;this.indexOf=this.href.indexOf;this.italics=this.href.italics;this.lastIndexOf=this.href.lastIndexOf;this.link=this.href.link;this.match=this.href.match;this.slice=this.href.slice;this.small=this.href.small;this.split=this.href.split;this.strike=this.href.strike;this.sub=this.href.sub;this.substr=this.href.substr;this.substring=this.href.substring;this.toLowerCase=this.href.toLowerCase;this.toUpperCase=this.href.toUpperCase};_ASProxy.DocCookieString=document.cookie;_ASProxy.GetDocumentCookie=function(){_ASProxy.DocCookieString=document.cookie;var e="";for(var t=0;t<_reqInfo.appliedCookiesList.length;t++){var n=_reqInfo.appliedCookiesList[t];var r=_ASProxy.GetCookieByName(n);if(r==null)continue;var i=_ASProxy.ParseASProxyCookie(r);if(i!=null&&i.length>0)e+=i}return e};_ASProxy.ParseASProxyCookie=function(e){var t="";var n=e.split("&");for(var r=0;r<n.length;r++){var i=null;var s=null;var o=null;var u=n[r];var a=u.split(";");for(var f=0;f<a.length;f++){var l=a[f];var c=l.indexOf("=");var h=l.substr(0,c).replace("+","");h=_ASProxy.StrTrim(h);var p=_ASProxy.StrTrim(l.substr(c+1,l.length-c-1));if(h=="Name")i=p;else if(h=="Value"){p=unescape(p);s=p}else if(h=="Path"){o=p}}if(i!=null&&s!=null){var d=i+"="+s;if(o==null||o=="")o="/";var v=o.toLowerCase();var m=_reqInfo.location.Pathname.toLowerCase();if(m.indexOf(v)!=0)continue;t+=d+"; "}}return t};_ASProxy.SetDocumentCookie=function(e){if(e==null||e=="")return;var t=_ASProxy.ParseStandardCookieForSet(e);return t};_ASProxy.ParseStandardCookieForSet=function(e){var t="";var n=null;var r=null;var i=null;var s=null;var o=null;var u=null;var a=false;var f=e.split(";");for(var l=0;l<f.length;l++){var c=f[l];var h=c.indexOf("=");var p=c.substr(0,h).replace("+","");p=_ASProxy.StrTrim(p);var d=_ASProxy.StrTrim(c.substr(h+1,c.length-h-1));if(l==0){n=p;r=d}else if(p=="expires"){i=d}else if(p=="max-age"){s=d}else if(p=="domain"){o=d}else if(p=="path"){u=d}else if(p=="secure"){a=true}}var v="";if(n==null||r==null){return null}else{v="Name="+n;v+="; Value="+escape(r);if(i!=null)v+="; Expires="+i;if(s!=null)v+="; Max-Age="+s;if(o!=null)v+="; Domain="+o;if(u!=null)v+="; Path="+u;if(a)v+="; Secure=True"}var m=_reqInfo.cookieName;var g="";var y="";if(o!=null&&o!=""){m=_ASProxy.GetASProxyCookieName(o)}g=v;var b=_ASProxy.GetCookieByName(m);if(b!=null&&b!=""){g+="& "+b}g=escape(g);y=m+"="+g;if(!_userConfig.TempCookies){if(i!=null)y+="; expires="+i;if(s!=null)y+="; max-age="+s}y+="; path=/";return y};_ASProxy.GetCookieByName=function(e){var t=e;var n=_ASProxy.DocCookieString.split(";");for(var r=0;r<n.length;r++){var i=n[r].split("=");var s=_ASProxy.StrTrim(i[0]);if(t==s)return unescape(i[1])}return null};_ASProxy.GetASProxyCookieName=function(e){return e+_reqInfo.cookieNameExt};_ASProxy.ParseHtml=function(e){if(typeof e!="string")return e;var t=/\.(src)\s*=\s*([^;}]+)/ig;e=e.replace(t,".$1=__UrlEncoder($2,ENC_Any)");t=/\.(action|location|href)\s*=\s*([^;}]+)/ig;e=e.replace(t,".$1=__UrlEncoder($2)");t=/\.innerHTML\s*(\+)?=\s*([^};]+)\s*/ig;e=e.replace(t,".innerHTML$1=_ASProxy.ParseHtml($2)");t=/\s(href|action)\s*=\s*(["']?)([^"'\s>]+)/ig;while(match=t.exec(e)){e=e.replace(match[0]," "+match[1]+"="+match[2]+__UrlEncoder(match[3]))}t=/\s(src|background)\s*=\s*(["']?)([^"'\s>]+)/ig;while(match=t.exec(e)){e=e.replace(match[0]," "+match[1]+"="+match[2]+__UrlEncoder(match[3],ENC_Any))}t=/url\s*\(['"]?([^'"\)]+)['"]?\)/ig;while(match=t.exec(e))e=e.replace(match[0],"url("+__UrlEncoder(match[1],ENC_Any)+")");t=/@import\s*['"]([^'"\(\)]+)['"]/ig;while(match=t.exec(e))e=e.replace(match[0],'@import "'+__UrlEncoder(match[1],ENC_Any)+'"');return e};_ASProxy.ParseJs=function(e){return _ASProxy.ParseServerSide(e,0,false)};_ASProxy.ParseServerSide=function(e,t,n,r){responseObject={readyState:0,responseText:""};var i=_ASProxy.Pages.pgParser;var s="";if(t==0)s="js";else if(t==1)s="html";n=n?true:false;i+="?dec="+(_userConfig.EncodeUrl+0);i+="&type="+s;i+="&url=";if(_userConfig.EncodeUrl)i+=_ASProxy.B64UnknownerAdd(_Base64_encode(_reqInfo.pageUrl));else i+=escape(url);var o;if(typeof _AJAXInternal!="undefined")o=new _AJAXInternal;else o=new XMLHttpRequest;o.onreadystatechange=function(){if(o.readyState==4){responseObject.readyState=o.readyState;responseObject.responseText=o.responseText;if(typeof r!="undefined")r(responseObject)}};o.open("POST",i,n);o.send(e);if(!n){responseObject.readyState=o.readyState;responseObject.responseText=o.responseText;return responseObject}};_ASProxy.CallOrgSetAttrib=function(e,t,n){if(e==null)return;if(typeof e.OrgSetAttrib=="undefined")e.setAttribute(t,n);else e.OrgSetAttrib(t,n)};_ASProxy.CallOrgGetAttrib=function(e,t){if(e==null)return"";if(typeof e.OrgGetAttrib=="undefined")return e.getAttribute(t)+"";else return e.OrgGetAttrib(t)+""};_ASProxy.OverrideHtmlSetters=function(){if(typeof window.__defineSetter__=="undefined")return;try{var e=[HTMLTitleElement,HTMLTextAreaElement,HTMLTableSectionElement,HTMLTableRowElement,HTMLTableElement,HTMLTableColElement,HTMLTableCellElement,HTMLTableCaptionElement,HTMLStyleElement,HTMLSelectElement,HTMLScriptElement,HTMLParamElement,HTMLParagraphElement,HTMLOptionElement,HTMLOListElement,HTMLObjectElement,HTMLMetaElement,HTMLMapElement,HTMLMapElement,HTMLLinkElement,HTMLLIElement,HTMLLegendElement,HTMLLabelElement,HTMLIsIndexElement,HTMLInputElement,HTMLImageElement,HTMLIFrameElement,HTMLHtmlElement,HTMLHRElement,HTMLHeadingElement,HTMLHeadElement,HTMLFrameSetElement,HTMLFrameElement,HTMLFormElement,HTMLFontElement,HTMLFieldSetElement,HTMLEmbedElement,HTMLDocument,HTMLDListElement,HTMLDivElement,HTMLButtonElement,HTMLBRElement,HTMLBodyElement,HTMLBaseFontElement,HTMLBaseElement,HTMLAreaElement,HTMLAnchorElement];try{e.push([HTMLElement,HTMLUListElement,HTMLQuoteElement,HTMLPreElement,HTMLModElement,HTMLMenuElement,HTMLDirectoryElement,HTMLAppletElement])}catch(t){_ASProxy.Log("Extra OverrideHtmlSetters",t)}var n=function(e,t,n){if(_ASProxy.IsEncodedByASProxy(t))return t;try{var r=e.toLowerCase();var i=n;if(i==null)i=(this.tagName+"").toLowerCase();else i=(i+"").toLowerCase();if(r=="src"){if(_ASProxy.IsEncodedByASProxy(t)){}else if(i=="img")t=__UrlEncoder(t,ENC_Images);else if(i=="iframe"||i=="frame")t=__UrlEncoder(t,ENC_Frames);else t=__UrlEncoder(t,ENC_Any)}else if(r=="href"){if(_ASProxy.IsEncodedByASProxy(t)){}else if(i=="a"||i=="base")t=__UrlEncoder(t);else t=__UrlEncoder(t,ENC_Any)}else if(r=="background"){if(!_ASProxy.IsEncodedByASProxy(t))t=__UrlEncoder(t,ENC_Images)}else if(r=="action"){if(_ASProxy.IsEncodedByASProxy(t)){}else if(i=="form"){t=t}else t=__UrlEncoder(t,ENC_Any)}else if(r=="innerHtml"){t=_ASProxy.ParseHtml(t)}}catch(s){_ASProxy.Log("_EncodeSetAttributeValue",s)}return t};_ASProxy.SetAttribute=function(e,t){try{if(e.toLowerCase()=="action"&&this.tagName.toLowerCase()=="form"){_ASProxy.Setter_FormAction(this,t)}else{t=n(e,t,this.tagName);this.OrgSetAttrib(e,t)}}catch(r){_ASProxy.Log("_ASProxy.SetAttribute",r)}};_ASProxy.GetAttribute=function(e,t){try{if(t==null)t=this;if(typeof t.OrgGetAttrib=="undefined")return t.getAttribute(e);if(e==null)return t.OrgGetAttrib(e);var n=t.OrgGetAttrib(e);var r=_ASProxy.DecodeASProxyUrl(n);if(n==r)return n;else return r}catch(i){_ASProxy.Log("_ASProxy.GetAttribute",i)}};_ASProxy.Setter_FormAction=function(e,t){var n=e.attributes["methodorginal"];if(n==null)n=n.value;else n=e.method;e.OrgSetAttrib("asproxydone","1");e.OrgSetAttrib("methodorginal",n);var r;if(_ASProxy.IsEncodedByASProxy(t)==false)r=__UrlEncoder(t,ENC_Page,false,"method="+n);else r=t;e.OrgSetAttrib("action",r);e.method="POST";e.OrgSetAttrib("encodedurl",r)};_ASProxy.Setter_Src=function(e){this.OrgSetAttrib("src",n("src",e,this.tagName))};_ASProxy.Setter_Href=function(e){this.OrgSetAttrib("href",n("href",e,this.tagName))};_ASProxy.Setter_Background=function(e){this.OrgSetAttrib("background",n("background",e,this.tagName))};_ASProxy.Setter_InnerHtml=function(e){this.OrgSetAttrib("innerHtml",n("innerHtml",e,this.tagName))};_ASProxy.Setter_Action=function(e){try{if(this.tagName.toLowerCase()=="form"){_ASProxy.Setter_FormAction(this,e)}else{this.OrgSetAttrib("action",n("action",e,this.tagName))}}catch(t){_ASProxy.Log("Setter_Action",t)}};_ASProxy.Getter_Src=function(){return _ASProxy.GetAttribute("src",this)};_ASProxy.Getter_Href=function(){return _ASProxy.GetAttribute("href",this)};_ASProxy.Getter_Background=function(){return _ASProxy.GetAttribute("background",this)};_ASProxy.Getter_Action=function(){return _ASProxy.GetAttribute("action",this)};for(i=0;i<e.length;i++){var r=e[i].prototype;if(r==null)continue;r.OrgSetAttrib=r.setAttribute;r.setAttribute=_ASProxy.SetAttribute;r.OrgGetAttrib=r.getAttribute;r.getAttribute=_ASProxy.GetAttribute;r.__defineSetter__("src",_ASProxy.Setter_Src);r.__defineSetter__("action",_ASProxy.Setter_Action);r.__defineSetter__("href",_ASProxy.Setter_Href);r.__defineSetter__("background",_ASProxy.Setter_Background);r.__defineSetter__("innerHtml",_ASProxy.Setter_InnerHtml);r.__defineGetter__("src",_ASProxy.Getter_Src);r.__defineGetter__("action",_ASProxy.Getter_Action);r.__defineGetter__("href",_ASProxy.Getter_Href);r.__defineGetter__("background",_ASProxy.Getter_Background)}}catch(t){_ASProxy.Log("OverrideHtmlSetters ALL",t)}};_ASProxy.OverrideStandardsDeclare=function(){_ASProxy.WindowEval=function(e){if(typeof e=="string"&&_ASProxy.ServerSideParser){var t=e;var n=false;if(typeof _XFloatBar!="undefined"){n=true;ORG_MSG_("<div style='padding:5px 4px;font-size:12px;'><strong>ASProxy:</strong> <span style='color:maroon;'>A background proccess is working, please wait a few seconds...</span></div>")}var r=_ASProxy.ParseServerSide(e,0,false);if(n)ORG_OUT_();if(r.readyState==4)t=r.responseText;return window.OriginalEval(t)}else{return window.OriginalEval(e)}};_ASProxy.WindowOpen=function(e,t,n,r){if(_ASProxy.IsEncodedByASProxy(e))return window.OriginalOpen(e,t,n,r);else return window.OriginalOpen(__UrlEncoder(e),t,n,r)};_ASProxy.LocationAssign=function(e){if(_ASProxy.IsEncodedByASProxy(e))window.location.href=e;else{e=__UrlEncoder(e);window.location.href=e}return e};_ASProxy.LocationReplace=function(e){var t;if(_ASProxy.IsEncodedByASProxy(e))t=e;else t=__UrlEncoder(e);if(window.location.replace==_ASProxy.LocationReplace)return window.LocationReplace(t);else return window.location.replace(t)};_ASProxy.LocationReload=function(){if(window.location.reload==_ASProxy.LocationReload)return window.LocationReload();else return window.location.reload()};_ASProxy.DocumentWrite=function(){var e=arguments[0];if(_ASProxy.ParseHtml){e=_ASProxy.ParseHtml(e);return document.OriginalWrite(e)}};_ASProxy.DocumentWriteLn=function(){var e=arguments[0];if(_ASProxy.ParseHtml){e=_ASProxy.ParseHtml(e);return document.OriginalWriteLn(e)}}};_ASProxy.OverrideStandards=function(){if(_ASProxy.ServerSideParser){try{window.eval=_ASProxy.WindowEval}catch(e){_ASProxy.Log("OVR window.eval failed",e)}}try{document.XDomain=__XUrl.host}catch(e){_ASProxy.Log("document.XDOMAIN failed",e)}try{window.open=_ASProxy.WindowOpen}catch(e){_ASProxy.Log("OVR window.open failed",e)}try{document.open=_ASProxy.WindowOpen}catch(e){_ASProxy.Log("OVR document.open failed",e)}try{open=_ASProxy.WindowOpen}catch(e){_ASProxy.Log("OVR open failed",e)}try{window.location.replace=_ASProxy.LocationReplace}catch(e){_ASProxy.Log("OVR window.location failed",e)}try{location.replace=_ASProxy.LocationReplace}catch(e){_ASProxy.Log("OVR location.replace failed",e)}try{document.write=_ASProxy.DocumentWrite}catch(e){_ASProxy.Log("OVR document.write failed",e)}try{document.writeln=_ASProxy.DocumentWriteLn}catch(e){_ASProxy.Log("OVR document.writeln failed",e)}};Object.extend=function(e,t,n){for(var r in t){if(n==false&&e[r]!=null){continue}e[r]=t[r]}return e};if(typeof XMLHttpRequest!="undefined")_ASProxyXMLHttpRequest=XMLHttpRequest;else _ASProxyXMLHttpRequest=null;_AJAXInternal=function(){try{return new _ASProxyXMLHttpRequest}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}};XMLHttpRequest=function(){this._ajax=new _AJAXInternal;this._headers=new Array;this._onreadystatechange=new Array;this._onload=new Array;this._onerror=new Array;this._onprogress=new Array;this._onabort=new Array;this._ontimeout=new Array;this._onuploadprogress=new Array;this._onloadstart=new Array};Object.extend(XMLHttpRequest.prototype,{_async:false,_reqUrl:"",_caller:null,_refresh:function(){_caller=this;this._attachAllEvent()},_attachAllEvent:function(){try{this._ajax.onreadystatechange=this._readystatechange}catch(e){}try{this._ajax.onload=this._load}catch(e){}try{if(this.onerror!=null||this._onerror.length>0)this._ajax.onerror=this._error}catch(e){}try{if(this.onprogress!=null||this._onprogress.length>0)this._ajax.onprogress=this._progress}catch(e){}try{if(this.onabort!=null||this._onabort.length>0)this._ajax.onabort=this._abort}catch(e){}try{if(this.ontimeout!=null||this._ontimeout.length>0)this._ajax.ontimeout=this._timeout}catch(e){}try{if(this.onuploadprogress!=null||this._onuploadprogress.length>0)this._ajax.onuploadprogress=this._uploadprogress}catch(e){}try{if(this.onloadstart!=null||this._onloadstart.length>0)this._ajax.onloadstart=this._loadstart}catch(e){}},_updateProperties:function(){try{this.responseText=this._ajax.responseText}catch(e){}try{this.responseXML=this._ajax.responseXML}catch(e){}try{this.status=this._ajax.status}catch(e){}try{this.statusText=this._ajax.statusText}catch(e){}try{this.readyState=this._ajax.readyState}catch(e){}try{this.responseBody=this._ajax.responseBody}catch(e){}try{this.multipart=this._ajax.multipart}catch(e){}},_readystatechange:function(e){if(_caller!=null&&typeof _caller._updateProperties!="undefined"){_caller._updateProperties();if(_caller.onreadystatechange!=null)_caller.onreadystatechange(e);_caller._fireEventListeners(_caller._onreadystatechange,e)}},_load:function(e){if(_caller!=null&&typeof _caller._updateProperties!="undefined"){_caller._updateProperties();if(_caller.onload!=null)_caller.onload(e);_caller._fireEventListeners(_caller._onload,e)}},_error:function(e){if(_caller!=null&&typeof _caller._updateProperties!="undefined"){_caller._updateProperties();if(_caller.onerror!=null)_caller.onerror(e);_caller._fireEventListeners(_caller._onerror,e)}},_progress:function(e){if(_caller!=null&&typeof _caller._updateProperties!="undefined"){_caller._updateProperties();if(_caller.onprogress!=null)_caller.onprogress(e);_caller._fireEventListeners(_caller._onprogress,e)}},_abort:function(e){if(_caller!=null&&typeof _caller._updateProperties!="undefined"){_caller._updateProperties();if(_caller.onabort!=null)_caller.onabort(e);_caller._fireEventListeners(_caller._onabort,e)}},_timeout:function(e){if(_caller!=null&&typeof _caller._updateProperties!="undefined"){_caller._updateProperties();if(_caller.ontimeout!=null)_caller.ontimeout(e);_caller._fireEventListeners(_caller._ontimeout,e)}},_uploadprogress:function(e){if(_caller!=null&&typeof _caller._updateProperties!="undefined"){_caller._updateProperties();if(_caller.onuploadprogress!=null)_caller.onuploadprogress(e);_caller._fireEventListeners(_caller._onuploadprogress,e)}},_loadstart:function(e){if(_caller!=null&&typeof _caller._updateProperties!="undefined"){_caller._updateProperties();if(_caller.onloadstart!=null)_caller.onloadstart(e);_caller._fireEventListeners(_caller._onloadstart,e)}},_fireEventListeners:function(e,t){if(typeof e!="object")return;for(var n in e){var r=e[n];try{r(t)}catch(i){}}},UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,abort:function(){this._refresh();this._ajax.abort();this._updateProperties()},getAllResponseHeaders:function(){this._refresh();this._updateProperties();return this._ajax.getAllResponseHeaders()},getResponseHeader:function(e){this._refresh();this._updateProperties();return this._ajax.getResponseHeader(e)},open:function(e,t,n,r,i){if(arguments.length<3)n=true;this._reqUrl=t;t=this._EncodeAJAXUrl(e,t,r,i);e=this._ASProxyEncodeAJAXMethod(e);this._async=n;this._refresh();this._ajax.open(e,t,n,r,i);this._updateProperties()},send:function(e){var t=this._EncodeArray(this._headers);this._ajax.setRequestHeader("X-ASProxy-AJAX-Headers",t);this._ajax.setRequestHeader("X-ASProxy-AJAX-Referrer",_reqInfo.pageUrl);if(e&&e.nodeType){e=window.XMLSerializer?(new window.XMLSerializer).serializeToString(e):e.xml;if(!this._headers["Content-Type"])this._ajax.setRequestHeader("Content-Type","application/xml")}this._refresh();this._ajax.send(e);this._updateProperties()},sendAsBinary:function(e){var t=this._EncodeArray(this._headers);this._ajax.setRequestHeader("X-ASProxy-AJAX-Headers",t);this._ajax.setRequestHeader("X-ASProxy-AJAX-Referrer",_reqInfo.pageUrl);this._refresh();this._ajax.sendAsBinary(e);this._updateProperties()},setRequestHeader:function(e,t){_ArrayAdd(this._headers,e,t);this._refresh();this._ajax.setRequestHeader(e,t);this._updateProperties()},overrideMimeType:function(e){this._refresh();this._ajax.overrideMimeType(e);this._updateProperties()},toString:function(){return"["+"XMLHttpRequest"+"]"},addEventListener:function(e,t,n){var r="_on"+e;var i=t.toString()+n.valueOf();var s=this[r];if(s!=null){_ArrayAdd(this[r],i,t);this[r].push(function(){})}else _ASProxy.AttachEvent(this._ajax,e,t,n)},removeEventListener:function(e,t,n){var r="_on"+e;var i=t.toString()+n.valueOf();var s=this[r];if(array!=null)delete s[i];else _ASProxy.DetachEvent(this._ajax,e,t,n)},dispatchEvent:function(e){this._ajax.dispatchEvent(e)},readyState:0,responseText:"",responseXML:null,responseBody:0,status:0,statusText:"",channel:null,multipart:false,onreadystatechange:null,onload:null,onerror:null,onprogress:null,onabort:null,ontimeout:null,onuploadprogress:null,onloadstart:null},true);Object.extend(XMLHttpRequest.prototype,{_ASProxyEncodeAJAXMethod:function(e){if(e==null)return e;var t=e.toLowerCase();if(t=="post")return"POST";return"GET"},_EncodeArray:function(e){var t="{";for(var n in e){var r=e[n];if(r!=null&&typeof r!="function")t+='"'+n+'"|#|'+'"'+r+'"|^|'}t+="}";return t},_ASProxyEncoderAJAXUrl:function(e,t,n,r){var i=t;var s;if(_ASProxy.IsClientSideUrl(i)||_ASProxy.IsSelfBookmarkUrl(i))return i;if(_ASProxy.IsEncodedByASProxy(i)){var o=_ASProxy.GetUrlParamValue("ajaxurl",i)+"";if(o=="")o=_ASProxy.GetUrlParamValue("url",i)+"";if(o!=""){if(_userConfig.EncodeUrl)o=_Base64_decode(_ASProxy.B64UnknownerRemove(o));else o=unescape(o);i=o}}i=_ASProxy.CorrectLocalUrlToOrginal(i);if(_ASProxy.IsVirtualUrl(i))i=_ASProxy.JoinUrls(i,_reqInfo.pageUrl,_reqInfo.pagePath,_reqInfo.rootUrl);var u=_ASProxy.Pages.pgAjax;u+="?dec="+(_userConfig.EncodeUrl+0)+"&ajaxurl=";s=u;if(_userConfig.EncodeUrl)s+=_ASProxy.B64UnknownerAdd(_Base64_encode(i));else s+=escape(i);s+="&method="+e;if(n!=null)s+="&use="+_ASProxy.B64UnknownerAdd(_Base64_encode(n));if(r!=null)s+="&pas="+_ASProxy.B64UnknownerAdd(_Base64_encode(r));return s},_EncodeAJAXUrl:function(e,t,n,r){return this._ASProxyEncoderAJAXUrl(e,t,n,r)}},true);if(_ASProxyXMLHttpRequest&&_ASProxyXMLHttpRequest.wrapped)XMLHttpRequest.wrapped=_ASProxyXMLHttpRequest.wrapped;_ASProxy.StartupDynamicEncoders=function(){window.setTimeout("_ASProxy.Enc.EncodeLinks();",500);window.setTimeout("_ASProxy.Enc.EncodeImages();",700);window.setTimeout("_ASProxy.Enc.EncodeInputImages();",2e3);window.setTimeout("_ASProxy.Enc.EncodeForms();",1e3);window.setTimeout("_ASProxy.Enc.EncodeFrames();",2e3);window.setTimeout("_ASProxy.Enc.EncodeScriptSources();",4e3)};_ASProxy.Initialize=function(){_ASProxy.OverrideStandardsDeclare();__XUrl=new _ASProxy.LocationObject;_ASProxy.ReqLocation=__XUrl;document.__XUrl=__XUrl;_ASProxy.OverrideStandards();_ASProxy.OverrideHtmlSetters();if(_ASProxy.DynamicEncoders)_ASProxy.StartupDynamicEncoders()};if(_ASProxyLoaded==false)_ASProxy.Initialize()