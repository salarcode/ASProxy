// ASProxy Dynamic Encoder
// ASProxy encoder for dynamically created objects //
// Last update: 2020-04-25 coded by Salar.Kh //
// Licende: MPL 1.1 License agreement.
function __UrlEncoder(e,r,t,o){return _ASProxy.IsClientSideUrl(e)||_ASProxy.IsSelfBookmarkUrl(e)||_ASProxy.IsEncodedByASProxy(e)?e:(1!=t&&(e=_ASProxy.CorrectLocalUrlToOrginal(e)),_ASProxy.IsVirtualUrl(e)&&(e=_ASProxy.JoinUrls(e,_reqInfo.pageUrl,_reqInfo.pagePath,_reqInfo.rootUrl)),n=r==ENC_Images?_ASProxy.Pages.pgImages:r==ENC_Any?_ASProxy.Pages.pgGetAny:r==ENC_Frames?_ASProxy.Pages.pgGetHtml:_reqInfo.ASProxyPageName,_ASProxy.Debug_UseAbsoluteUrl&&(n=_reqInfo.ASProxyPath+n),n+="?dec="+(_userConfig.EncodeUrl+0)+"&url=",""!=(a=_ASProxy.ReturnBookmarkPart(e))&&(e=_ASProxy.RemoveBookmarkPart(e)),i=n,_userConfig.EncodeUrl?i+=_ASProxy.B64UnknownerAdd(_Base64_encode(e)):i+=escape(e),null!=o&&(i+="&"+o),i+=a);var n,a,i}function __CookieGet(e){return _ASProxy.GetDocumentCookie()}function __CookieSet(e){return _ASProxy.SetDocumentCookie(e)}function _ArrayAdd(e,r,t){e[r]=t}_ASProxyLoaded="undefined"!=typeof _ASProxyLoaded,_ASProxy={Debug_UseAbsoluteUrl:!1,DynamicEncoders:!0,TraceCookies:!1,LogEnabled:!1,ServerSideParser:!1,Activities:{},Pages:{pgGetAny:"getany.ashx",pgGetHtml:"gethtml.ashx",pgGetJS:"getjs.ashx",pgImages:"images.ashx",pgDownload:"download.ashx",pgAuthorization:"authorization.aspx",pgAjax:"ajax.ashx",pgParser:"parser.ashx"},ClientSideUrls:["mailto:","file://","javascript:","vbscript:","jscript:","vbs:","ymsgr:","data:"],NonVirtualUrls:["http://","https://","mailto:","ftp://","file://","telnet://","news://","nntp://","ldap://","ymsgr:","javascript:","vbscript:","jscript:","vbs:","data:"]},"undefined"==typeof _reqInfo&&(_reqInfo={ASProxyPageName:"surf.aspx"}),_ASProxy.EncodedUrls=[_reqInfo.ASProxyPageName+"?dec=",_ASProxy.Pages.pgAjax+"?dec=",_ASProxy.Pages.pgGetHtml+"?dec=",_ASProxy.Pages.pgImages+"?dec=",_ASProxy.Pages.pgGetJS+"?dec=",_ASProxy.Pages.pgDownload+"?dec=",_ASProxy.Pages.pgAuthorization+"?dec=",_ASProxy.Pages.pgGetAny+"?dec="],document.OriginalWrite=document.write,document.OriginalWriteLn=document.writeln,window.OriginalOpen=window.open,window.LocationReplace=window.location.replace,window.LocationAssign=window.location.assign,window.LocationReload=window.location.reload,window.OriginalEval=window.eval,ENC_Page=0,ENC_Images=1,ENC_Any=2,ENC_Frames=3,_ASProxy.JoinUrls=function(e,r,t,o){return"string"!=typeof e||0==e.length?r:(t.lastIndexOf("/")!=t.length-1&&(t+="/"),o.lastIndexOf("/")!=o.length-1&&(o+="/"),0==e.indexOf("/",0)?o+"."+e:t+e)},_ASProxy.IsClientSideUrl=function(e){if("string"!=typeof e)return!1;for(e=e.toLowerCase(),i=0;i<_ASProxy.ClientSideUrls.length;i++)if(_ASProxy.StrStartsWith(e,_ASProxy.ClientSideUrls[i]))return!0;return!1},_ASProxy.IsVirtualUrl=function(e){if("string"!=typeof e)return!0;for(e=e.toLowerCase(),i=0;i<_ASProxy.NonVirtualUrls.length;i++)if(_ASProxy.StrStartsWith(e,_ASProxy.NonVirtualUrls[i]))return!1;return!0},_ASProxy.IsSelfBookmarkUrl=function(e){if("string"!=typeof e)return!1;if(_ASProxy.StrStartsWith(e,"#"))return!0;e=e.toLowerCase();var r=window.location.href.toLowerCase()+"#";return 0==e.indexOf(r,0)},_ASProxy.ReturnBookmarkPart=function(e){if("string"!=typeof e)return"";var r=e.indexOf("#",0);return-1!=r?e=e.substring(r,e.length):""},_ASProxy.RemoveBookmarkPart=function(e){if("string"!=typeof e)return null;var r=e.indexOf("#",0);return-1!=r?e=e.substring(0,r):e},_ASProxy.CorrectLocalUrlToOrginalCheck=function(e){return _ASProxy.IsClientSideUrl(e)||_ASProxy.IsSelfBookmarkUrl(e)?e:_ASProxy.CorrectLocalUrlToOrginal(e)},_ASProxy.CorrectLocalUrlToOrginal=function(e){if("string"!=typeof e)return null;var r=e.toLowerCase(),t=_reqInfo.ASProxyRoot.toLowerCase(),o=_reqInfo.ASProxyPath.toLowerCase(),n=_reqInfo.ASProxyPageName.toLowerCase(),a=_reqInfo.pageUrlNoQuery,i=!1,l=r.indexOf(n,0),s=n.length;if(-1==l&&(l=r.indexOf(o,0),s=o.length,a=_reqInfo.pagePath,i=!0),-1==l&&(l=r.indexOf(t,0),s=t.length,a=_reqInfo.rootUrl,i=!0),"/"==a.substr(a.length-1,1)&&(a=a.substr(0,a.length-1),i=!0),0!=l)return e;var c=e.substr(s,e.length),_="/";return 0!=i&&"/"!=c.substr(0,1)||(_=""),a+_+c},_ASProxy.B64UnknownerAdd=function(e){if("string"!=typeof e)return _reqInfo.UrlUnknowner;var r=_reqInfo.UrlUnknowner.toLowerCase(),t=e.toLowerCase();return!_ASProxy.StrEndsWith(t,r)?e+_reqInfo.UrlUnknowner:e},_ASProxy.B64UnknownerRemove=function(e){if("string"!=typeof e)return e;var r=_reqInfo.UrlUnknowner.toLowerCase(),t=e.toLowerCase().indexOf(r);return-1<t?e.substring(0,t):e},_ASProxy.HasB64Unknowner=function(e){if("string"!=typeof e)return e;var r=_reqInfo.UrlUnknowner.toLowerCase(),t=e.toLowerCase();return _ASProxy.StrEndsWith(t,r)},_ASProxy.Log=function(){if(_ASProxy.LogEnabled&&"undefined"!=typeof console)try{console.debug("ASProxy log:");for(var e="",r=0;r<arguments.length;r++)e+=arguments[r]+"\n";console.debug(e)}catch(e){}},_ASProxy.IsEncodedByASProxy=function(e){if("string"!=typeof e)return!1;e=e.toLowerCase();var r=_reqInfo.ASProxyPath.toLowerCase();for(i=0;i<_ASProxy.EncodedUrls.length;i++){if(_ASProxy.StrStartsWith(e,_ASProxy.EncodedUrls[i]))return!0;if(_ASProxy.StrStartsWith(e,r+_ASProxy.EncodedUrls[i]))return!0}return!1},_ASProxy.GetBookmarkOnlyForCurrentPage=function(e){if("string"!=typeof e)return e;var r=document.location.href.toLowerCase(),t=e.toLowerCase(),o=e.indexOf("#",0);return-1==o||-1==t.indexOf(r,0)?e:_reqInfo.pageUrl+e.substring(o,e.length)},_ASProxy.AttachEvent=function(e,r,t,o){try{if(null==e)return!1;if(e.addEventListener)return e.addEventListener(r,t,o),!0;if(e.attachEvent)return e.attachEvent("on"+r,t);try{e["on"+r]=t}catch(e){_ASProxy.Log('AttachEvent"on"',e)}}catch(e){_ASProxy.Log("AttachEvent",e)}},_ASProxy.DetachEvent=function(e,r,t,o){try{if(null==e)return!1;if(e.removeEventListener)return e.removeEventListener(r,t,o),!0;if(e.detachEvent)return e.detachEvent("on"+r,t);try{delete e["on"+r]}catch(e){_ASProxy.Log('DetachEvent"on"',e)}}catch(e){_ASProxy.Log("DetachEvent",e)}},_ASProxy.StrTrimLeft=function(e){return e.replace(/^\s*/,"")},_ASProxy.StrTrimRight=function(e){return e.replace(/\s*$/,"")},_ASProxy.StrTrim=function(e){return e.replace(/^\s+|\s+$/g,"")},_ASProxy.StrStartsWith=function(e,r){return!(0==e.length||e.length<r.length)&&e.substr(0,r.length)==r},_ASProxy.StrEndsWith=function(e,r){return!(0==e.length||e.length<r.length)&&e.substr(e.length-r.length)==r},_ASProxy.GetUrlParamValue=function(e,r){try{if(null==r||null==e)return"";e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(r);return null==t?"":t[1]}catch(e){return _ASProxy.Log("GetUrlParamValue failed!",e),""}},_ASProxy.DecodeASProxyUrl=function(e){if("string"!=typeof e)return e;if(!_ASProxy.IsEncodedByASProxy(e))return e;var r=_ASProxy.GetUrlParamValue("url",e)+"";return r?_ASProxy.HasB64Unknowner(e)?_Base64_decode(_ASProxy.B64UnknownerRemove(r)):unescape(r):e},_ASProxy.Enc={},_ASProxy.Enc.EncodeElements=function(e,r,t,o,n,a,i,l){var s,c=0;for(c=0;c<e.length;c++){var _=(s=e[c]).attributes[r],u=s[r];if(_=null!=_?_.value:u,0==_ASProxy.IsEncodedByASProxy(_)){var d=!1;if(null!=n&&null!=a){var y=s.attributes[n];if(null!=(y=null!=y?y.value:s[n])&&y.toLowerCase()!=a.toLowerCase())continue}var A=s.attributes.asproxydone;if(null==A||"1"!=A.value&&"2"!=A.value)d=!0;else if("1"==A.value){var S=s.attributes.encodedurl;if(null==S?(_ASProxy.CallOrgSetAttrib(s,"encodedurl",_),3==t&&i&&_ASProxy.CallOrgSetAttrib(s,i,l),d=!0):S=S.value,_!=S){if(_==window.location)continue;d=!0}}if(d){var h=_ASProxy.CorrectLocalUrlToOrginalCheck(_);if(u=_ASProxy.CorrectLocalUrlToOrginalCheck(u),_ASProxy.CallOrgSetAttrib(s,"asproxydone","1"),_ASProxy.CallOrgSetAttrib(s,"originalurl",_ASProxy.GetBookmarkOnlyForCurrentPage(u)),3==t&&i&&_ASProxy.CallOrgSetAttrib(s,i,l),o&&_userConfig.OrginalUrl&&("undefined"!=typeof ORG_IN_&&_ASProxy.AttachEvent(s,"mouseover",function(){ORG_IN_(this)}),"undefined"!=typeof ORG_OUT_&&_ASProxy.AttachEvent(s,"mouseout",function(){ORG_OUT_()})),_==window.location&&h==_)continue;h=__UrlEncoder(h,t,!0,null),_ASProxy.CallOrgSetAttrib(s,r,h),s[r]=h,_ASProxy.CallOrgSetAttrib(s,"encodedurl",h)}}}},_ASProxy.Enc.EncodeForms=function(){if(1==_userConfig.Forms){var e,r=0;for(r=0;r<document.forms.length;r++){var t=(e=document.forms.item(r)).attributes.action;if(t=null!=t?t.value:e.action,0==_ASProxy.IsEncodedByASProxy(t)){var o=!1,n=e.attributes.asproxydone,a=e.method;if(null==n||"1"!=n.value&&"2"!=n.value)o=!0;else if("1"==n.value){var i=e.attributes.encodedurl;i=null==i?"":i.value,a=null==(a=e.attributes.methodorginal)?e.method:a.value,-1==i.indexOf("://",0)&&(i=document.location.protocol+"//"+document.location.host+"/"+i),t!=i&&(o=!0)}if(o){_ASProxy.CallOrgSetAttrib(e,"asproxydone","1"),_ASProxy.CallOrgSetAttrib(e,"methodorginal",a);var l=__UrlEncoder(t,ENC_Page,!1,"method="+a);_ASProxy.CallOrgSetAttrib(e,"action",l),_ASProxy.CallOrgSetAttrib(e,"encodedurl",l),e.method="POST"}}}_ASProxy.DynamicEncoders&&window.setTimeout("_ASProxy.Enc.EncodeForms();",2e3)}},_ASProxy.Enc.EncodeFrames=function(){if(1==_userConfig.Frames){var e=document.documentElement.getElementsByTagName("iframe");try{_ASProxy.Enc.EncodeElements(e,"src",3,!1,null,null,"onload","_ASProxy.Enc.EncodeFrames()")}catch(e){_ASProxy.Log("Enc.EncodeFrames",e)}_ASProxy.DynamicEncoders&&window.setTimeout("_ASProxy.Enc.EncodeFrames();",5e3)}},_ASProxy.Enc.EncodeLinks=function(){if(1==_userConfig.Links){try{_ASProxy.Enc.EncodeElements(document.links,"href",0,!0)}catch(e){_ASProxy.Log("Enc.EncodeLinks",e)}_ASProxy.DynamicEncoders&&window.setTimeout("_ASProxy.Enc.EncodeLinks();",1e3)}},_ASProxy.Enc.EncodeImages=function(){if(1==_userConfig.Images){try{_ASProxy.Enc.EncodeElements(document.images,"src",1,!0)}catch(e){_ASProxy.Log("Enc.EncodeImages",e)}_ASProxy.DynamicEncoders&&window.setTimeout("_ASProxy.Enc.EncodeImages();",1e3)}},_ASProxy.Enc.EncodeInputImages=function(){if(1==_userConfig.Images){var e=document.documentElement.getElementsByTagName("input");try{_ASProxy.Enc.EncodeElements(e,"src",1,!0,"type","image")}catch(e){_ASProxy.Log("Enc.EncodeInputImages",e)}_ASProxy.DynamicEncoders&&window.setTimeout("_ASProxy.Enc.EncodeInputImages();",4e3)}},_ASProxy.Enc.EncodeScriptSources=function(){var e=document.documentElement.getElementsByTagName("script");try{_ASProxy.Enc.EncodeElements(e,"src",2,!1)}catch(e){_ASProxy.Log("Enc.EncodeScriptSources",e)}_ASProxy.DynamicEncoders&&window.setTimeout("_ASProxy.Enc.EncodeScriptSources();",4e3)},_ASProxy.LocationObject=function(){this.search=_reqInfo.location.Search,this.href=_reqInfo.pageUrl,this.hash=null!=window.location.hash&&""!=window.location.hash?window.location.hash:_reqInfo.location.Hash,this.host=_reqInfo.location.Host,this.hostname=_reqInfo.location.Hostname,this.pathname=_reqInfo.location.Pathname,this.port=_reqInfo.location.Port,this.protocol=_reqInfo.location.Protocol,this.replace=window.LocationReplace,this.assign=window.LocationAssign,this.replace=_ASProxy.LocationReplace,this.assign=_ASProxy.LocationAssign,this.reload=_ASProxy.LocationReload,this.URL=_reqInfo.pageUrl,this.toString=function(){return _reqInfo.pageUrl},this.toLocaleString=function(){return _reqInfo.pageUrl},this.length=this.href.length,this.anchor=this.href.anchor,this.big=this.href.big,this.blink=this.href.blink,this.bold=this.href.bold,this.charAt=this.href.charAt,this.charCodeAt=this.href.charCodeAt,this.fixed=this.href.fixed,this.fontcolor=this.href.fontcolor,this.fontsize=this.href.fontsize,this.fromCharCode=this.href.fromCharCode,this.indexOf=this.href.indexOf,this.italics=this.href.italics,this.lastIndexOf=this.href.lastIndexOf,this.link=this.href.link,this.match=this.href.match,this.slice=this.href.slice,this.small=this.href.small,this.split=this.href.split,this.strike=this.href.strike,this.sub=this.href.sub,this.substr=this.href.substr,this.substring=this.href.substring,this.toLowerCase=this.href.toLowerCase,this.toUpperCase=this.href.toUpperCase},_ASProxy.DocCookieString=document.cookie,_ASProxy.GetDocumentCookie=function(){_ASProxy.DocCookieString=document.cookie;for(var e="",r=0;r<_reqInfo.appliedCookiesList.length;r++){var t=_reqInfo.appliedCookiesList[r],o=_ASProxy.GetCookieByName(t);if(null!=o){var n=_ASProxy.ParseASProxyCookie(o);null!=n&&0<n.length&&(e+=n)}}return e},_ASProxy.ParseASProxyCookie=function(e){for(var r="",t=e.split("&"),o=0;o<t.length;o++){for(var n=null,a=null,i=null,l=t[o].split(";"),s=0;s<l.length;s++){var c=l[s],_=c.indexOf("="),u=c.substr(0,_).replace("+","");u=_ASProxy.StrTrim(u);var d=_ASProxy.StrTrim(c.substr(_+1,c.length-_-1));"Name"==u?n=d:"Value"==u?a=d=unescape(d):"Path"==u&&(i=d)}if(null!=n&&null!=a){var y=n+"="+a;null!=i&&""!=i||(i="/");var A=i.toLowerCase();if(0!=_reqInfo.location.Pathname.toLowerCase().indexOf(A))continue;r+=y+"; "}}return r},_ASProxy.SetDocumentCookie=function(e){if(null!=e&&""!=e)return _ASProxy.ParseStandardCookieForSet(e)},_ASProxy.ParseStandardCookieForSet=function(e){for(var r=null,t=null,o=null,n=null,a=null,i=null,l=!1,s=e.split(";"),c=0;c<s.length;c++){var _=s[c],u=_.indexOf("="),d=_.substr(0,u).replace("+","");d=_ASProxy.StrTrim(d);var y=_ASProxy.StrTrim(_.substr(u+1,_.length-u-1));0==c?(r=d,t=y):"expires"==d?o=y:"max-age"==d?n=y:"domain"==d?a=y:"path"==d?i=y:"secure"==d&&(l=!0)}var A="";if(null==r||null==t)return null;A="Name="+r,A+="; Value="+escape(t),null!=o&&(A+="; Expires="+o),null!=n&&(A+="; Max-Age="+n),null!=a&&(A+="; Domain="+a),null!=i&&(A+="; Path="+i),l&&(A+="; Secure=True");var S=_reqInfo.cookieName,h="",x="";null!=a&&""!=a&&(S=_ASProxy.GetASProxyCookieName(a)),h=A;var P=_ASProxy.GetCookieByName(S);return null!=P&&""!=P&&(h+="& "+P),x=S+"="+(h=escape(h)),_userConfig.TempCookies||(null!=o&&(x+="; expires="+o),null!=n&&(x+="; max-age="+n)),x+="; path=/"},_ASProxy.GetCookieByName=function(e){for(var r=e,t=_ASProxy.DocCookieString.split(";"),o=0;o<t.length;o++){var n=t[o].split("=");if(r==_ASProxy.StrTrim(n[0]))return unescape(n[1])}return null},_ASProxy.GetASProxyCookieName=function(e){return e+_reqInfo.cookieNameExt},_ASProxy.ParseHtml=function(e){if("string"!=typeof e)return e;var r=/\.(src)\s*=\s*([^;}]+)/gi;for(e=e.replace(r,".$1=__UrlEncoder($2,ENC_Any)"),r=/\.(action|location|href)\s*=\s*([^;}]+)/gi,e=e.replace(r,".$1=__UrlEncoder($2)"),r=/\.innerHTML\s*(\+)?=\s*([^};]+)\s*/gi,e=e.replace(r,".innerHTML$1=_ASProxy.ParseHtml($2)"),r=/\s(href|action)\s*=\s*(["']?)([^"'\s>]+)/gi;match=r.exec(e);)e=e.replace(match[0]," "+match[1]+"="+match[2]+__UrlEncoder(match[3]));for(r=/\s(src|background)\s*=\s*(["']?)([^"'\s>]+)/gi;match=r.exec(e);)e=e.replace(match[0]," "+match[1]+"="+match[2]+__UrlEncoder(match[3],ENC_Any));for(r=/url\s*\(['"]?([^'"\)]+)['"]?\)/gi;match=r.exec(e);)e=e.replace(match[0],"url("+__UrlEncoder(match[1],ENC_Any)+")");for(r=/@import\s*['"]([^'"\(\)]+)['"]/gi;match=r.exec(e);)e=e.replace(match[0],'@import "'+__UrlEncoder(match[1],ENC_Any)+'"');return e},_ASProxy.ParseJs=function(e){return _ASProxy.ParseServerSide(e,0,!1)},_ASProxy.ParseServerSide=function(e,r,t,o){responseObject={readyState:0,responseText:""};var n,a=_ASProxy.Pages.pgParser,i="";if(0==r?i="js":1==r&&(i="html"),t=!!t,a+="?dec="+(_userConfig.EncodeUrl+0),a+="&type="+i,a+="&url=",_userConfig.EncodeUrl?a+=_ASProxy.B64UnknownerAdd(_Base64_encode(_reqInfo.pageUrl)):a+=escape(url),(n=new("undefined"!=typeof _AJAXInternal?_AJAXInternal:XMLHttpRequest)).onreadystatechange=function(){4==n.readyState&&(responseObject.readyState=n.readyState,responseObject.responseText=n.responseText,void 0!==o&&o(responseObject))},n.open("POST",a,t),n.send(e),!t)return responseObject.readyState=n.readyState,responseObject.responseText=n.responseText,responseObject},_ASProxy.CallOrgSetAttrib=function(e,r,t){null!=e&&(void 0===e.OrgSetAttrib?e.setAttribute(r,t):e.OrgSetAttrib(r,t))},_ASProxy.CallOrgGetAttrib=function(e,r){return null==e?"":void 0===e.OrgGetAttrib?e.getAttribute(r)+"":e.OrgGetAttrib(r)+""},_ASProxy.OverrideHtmlSetters=function(){if(void 0!==window.__defineSetter__)try{var e=[HTMLTitleElement,HTMLTextAreaElement,HTMLTableSectionElement,HTMLTableRowElement,HTMLTableElement,HTMLTableColElement,HTMLTableCellElement,HTMLTableCaptionElement,HTMLStyleElement,HTMLSelectElement,HTMLScriptElement,HTMLParamElement,HTMLParagraphElement,HTMLOptionElement,HTMLOListElement,HTMLObjectElement,HTMLMetaElement,HTMLMapElement,HTMLMapElement,HTMLLinkElement,HTMLLIElement,HTMLLegendElement,HTMLLabelElement,HTMLIsIndexElement,HTMLInputElement,HTMLImageElement,HTMLIFrameElement,HTMLHtmlElement,HTMLHRElement,HTMLHeadingElement,HTMLHeadElement,HTMLFrameSetElement,HTMLFrameElement,HTMLFormElement,HTMLFontElement,HTMLFieldSetElement,HTMLEmbedElement,HTMLDocument,HTMLDListElement,HTMLDivElement,HTMLButtonElement,HTMLBRElement,HTMLBodyElement,HTMLBaseFontElement,HTMLBaseElement,HTMLAreaElement,HTMLAnchorElement];try{e.push([HTMLElement,HTMLUListElement,HTMLQuoteElement,HTMLPreElement,HTMLModElement,HTMLMenuElement,HTMLDirectoryElement,HTMLAppletElement])}catch(e){_ASProxy.Log("Extra OverrideHtmlSetters",e)}function t(e,r,t){if(_ASProxy.IsEncodedByASProxy(r))return r;try{var o=e.toLowerCase(),n=t;n=null==n?(this.tagName+"").toLowerCase():(n+"").toLowerCase(),"src"==o?_ASProxy.IsEncodedByASProxy(r)||(r=__UrlEncoder(r,"img"==n?ENC_Images:"iframe"==n||"frame"==n?ENC_Frames:ENC_Any)):"href"==o?_ASProxy.IsEncodedByASProxy(r)||(r="a"==n||"base"==n?__UrlEncoder(r):__UrlEncoder(r,ENC_Any)):"background"==o?_ASProxy.IsEncodedByASProxy(r)||(r=__UrlEncoder(r,ENC_Images)):"action"==o?_ASProxy.IsEncodedByASProxy(r)||(r="form"==n?r:__UrlEncoder(r,ENC_Any)):"innerHtml"==o&&(r=_ASProxy.ParseHtml(r))}catch(e){_ASProxy.Log("_EncodeSetAttributeValue",e)}return r}for(_ASProxy.SetAttribute=function(e,r){try{"action"==e.toLowerCase()&&"form"==this.tagName.toLowerCase()?_ASProxy.Setter_FormAction(this,r):(r=t(e,r,this.tagName),this.OrgSetAttrib(e,r))}catch(e){_ASProxy.Log("_ASProxy.SetAttribute",e)}},_ASProxy.GetAttribute=function(e,r){try{if(null==r&&(r=this),void 0===r.OrgGetAttrib)return r.getAttribute(e);if(null==e)return r.OrgGetAttrib(e);var t=r.OrgGetAttrib(e),o=_ASProxy.DecodeASProxyUrl(t);return t==o?t:o}catch(e){_ASProxy.Log("_ASProxy.GetAttribute",e)}},_ASProxy.Setter_FormAction=function(e,r){var t,o=e.attributes.methodorginal;o=null==o?o.value:e.method,e.OrgSetAttrib("asproxydone","1"),e.OrgSetAttrib("methodorginal",o),t=0==_ASProxy.IsEncodedByASProxy(r)?__UrlEncoder(r,ENC_Page,!1,"method="+o):r,e.OrgSetAttrib("action",t),e.method="POST",e.OrgSetAttrib("encodedurl",t)},_ASProxy.Setter_Src=function(e){this.OrgSetAttrib("src",t("src",e,this.tagName))},_ASProxy.Setter_Href=function(e){this.OrgSetAttrib("href",t("href",e,this.tagName))},_ASProxy.Setter_Background=function(e){this.OrgSetAttrib("background",t("background",e,this.tagName))},_ASProxy.Setter_InnerHtml=function(e){this.OrgSetAttrib("innerHtml",t("innerHtml",e,this.tagName))},_ASProxy.Setter_Action=function(e){try{"form"==this.tagName.toLowerCase()?_ASProxy.Setter_FormAction(this,e):this.OrgSetAttrib("action",t("action",e,this.tagName))}catch(e){_ASProxy.Log("Setter_Action",e)}},_ASProxy.Getter_Src=function(){return _ASProxy.GetAttribute("src",this)},_ASProxy.Getter_Href=function(){return _ASProxy.GetAttribute("href",this)},_ASProxy.Getter_Background=function(){return _ASProxy.GetAttribute("background",this)},_ASProxy.Getter_Action=function(){return _ASProxy.GetAttribute("action",this)},i=0;i<e.length;i++){var r=e[i].prototype;null!=r&&(r.OrgSetAttrib=r.setAttribute,r.setAttribute=_ASProxy.SetAttribute,r.OrgGetAttrib=r.getAttribute,r.getAttribute=_ASProxy.GetAttribute,r.__defineSetter__("src",_ASProxy.Setter_Src),r.__defineSetter__("action",_ASProxy.Setter_Action),r.__defineSetter__("href",_ASProxy.Setter_Href),r.__defineSetter__("background",_ASProxy.Setter_Background),r.__defineSetter__("innerHtml",_ASProxy.Setter_InnerHtml),r.__defineGetter__("src",_ASProxy.Getter_Src),r.__defineGetter__("action",_ASProxy.Getter_Action),r.__defineGetter__("href",_ASProxy.Getter_Href),r.__defineGetter__("background",_ASProxy.Getter_Background))}}catch(e){_ASProxy.Log("OverrideHtmlSetters ALL",e)}},_ASProxy.OverrideStandardsDeclare=function(){_ASProxy.WindowEval=function(e){if("string"==typeof e&&_ASProxy.ServerSideParser){var r=e,t=!1;"undefined"!=typeof _XFloatBar&&(t=!0,ORG_MSG_("<div style='padding:5px 4px;font-size:12px;'><strong>ASProxy:</strong> <span style='color:maroon;'>A background proccess is working, please wait a few seconds...</span></div>"));var o=_ASProxy.ParseServerSide(e,0,!1);return t&&ORG_OUT_(),4==o.readyState&&(r=o.responseText),window.OriginalEval(r)}return window.OriginalEval(e)},_ASProxy.WindowOpen=function(e,r,t,o){return _ASProxy.IsEncodedByASProxy(e)?window.OriginalOpen(e,r,t,o):window.OriginalOpen(__UrlEncoder(e),r,t,o)},_ASProxy.LocationAssign=function(e){return _ASProxy.IsEncodedByASProxy(e)||(e=__UrlEncoder(e)),window.location.href=e},_ASProxy.LocationReplace=function(e){var r;return r=_ASProxy.IsEncodedByASProxy(e)?e:__UrlEncoder(e),window.location.replace==_ASProxy.LocationReplace?window.LocationReplace(r):window.location.replace(r)},_ASProxy.LocationReload=function(){return window.location.reload==_ASProxy.LocationReload?window.LocationReload():window.location.reload()},_ASProxy.DocumentWrite=function(){var e=arguments[0];if(_ASProxy.ParseHtml)return e=_ASProxy.ParseHtml(e),document.OriginalWrite(e)},_ASProxy.DocumentWriteLn=function(){var e=arguments[0];if(_ASProxy.ParseHtml)return e=_ASProxy.ParseHtml(e),document.OriginalWriteLn(e)}},_ASProxy.OverrideStandards=function(){if(_ASProxy.ServerSideParser)try{window.eval=_ASProxy.WindowEval}catch(e){_ASProxy.Log("OVR window.eval failed",e)}try{document.XDomain=__XUrl.host}catch(e){_ASProxy.Log("document.XDOMAIN failed",e)}try{window.open=_ASProxy.WindowOpen}catch(e){_ASProxy.Log("OVR window.open failed",e)}try{document.open=_ASProxy.WindowOpen}catch(e){_ASProxy.Log("OVR document.open failed",e)}try{open=_ASProxy.WindowOpen}catch(e){_ASProxy.Log("OVR open failed",e)}try{window.location.replace=_ASProxy.LocationReplace}catch(e){_ASProxy.Log("OVR window.location failed",e)}try{location.replace=_ASProxy.LocationReplace}catch(e){_ASProxy.Log("OVR location.replace failed",e)}try{document.write=_ASProxy.DocumentWrite}catch(e){_ASProxy.Log("OVR document.write failed",e)}try{document.writeln=_ASProxy.DocumentWriteLn}catch(e){_ASProxy.Log("OVR document.writeln failed",e)}},Object.extend=function(e,r,t){for(var o in r)0==t&&null!=e[o]||(e[o]=r[o]);return e},_ASProxyXMLHttpRequest="undefined"!=typeof XMLHttpRequest?XMLHttpRequest:null,_AJAXInternal=function(){try{return new _ASProxyXMLHttpRequest}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}},XMLHttpRequest=function(){this._ajax=new _AJAXInternal,this._headers=new Array,this._onreadystatechange=new Array,this._onload=new Array,this._onerror=new Array,this._onprogress=new Array,this._onabort=new Array,this._ontimeout=new Array,this._onuploadprogress=new Array,this._onloadstart=new Array},Object.extend(XMLHttpRequest.prototype,{_async:!1,_reqUrl:"",_caller:null,_refresh:function(){(_caller=this)._attachAllEvent()},_attachAllEvent:function(){try{this._ajax.onreadystatechange=this._readystatechange}catch(e){}try{this._ajax.onload=this._load}catch(e){}try{(null!=this.onerror||0<this._onerror.length)&&(this._ajax.onerror=this._error)}catch(e){}try{(null!=this.onprogress||0<this._onprogress.length)&&(this._ajax.onprogress=this._progress)}catch(e){}try{(null!=this.onabort||0<this._onabort.length)&&(this._ajax.onabort=this._abort)}catch(e){}try{(null!=this.ontimeout||0<this._ontimeout.length)&&(this._ajax.ontimeout=this._timeout)}catch(e){}try{(null!=this.onuploadprogress||0<this._onuploadprogress.length)&&(this._ajax.onuploadprogress=this._uploadprogress)}catch(e){}try{(null!=this.onloadstart||0<this._onloadstart.length)&&(this._ajax.onloadstart=this._loadstart)}catch(e){}},_updateProperties:function(){try{this.responseText=this._ajax.responseText}catch(e){}try{this.responseXML=this._ajax.responseXML}catch(e){}try{this.status=this._ajax.status}catch(e){}try{this.statusText=this._ajax.statusText}catch(e){}try{this.readyState=this._ajax.readyState}catch(e){}try{this.responseBody=this._ajax.responseBody}catch(e){}try{this.multipart=this._ajax.multipart}catch(e){}},_readystatechange:function(e){null!=_caller&&void 0!==_caller._updateProperties&&(_caller._updateProperties(),null!=_caller.onreadystatechange&&_caller.onreadystatechange(e),_caller._fireEventListeners(_caller._onreadystatechange,e))},_load:function(e){null!=_caller&&void 0!==_caller._updateProperties&&(_caller._updateProperties(),null!=_caller.onload&&_caller.onload(e),_caller._fireEventListeners(_caller._onload,e))},_error:function(e){null!=_caller&&void 0!==_caller._updateProperties&&(_caller._updateProperties(),null!=_caller.onerror&&_caller.onerror(e),_caller._fireEventListeners(_caller._onerror,e))},_progress:function(e){null!=_caller&&void 0!==_caller._updateProperties&&(_caller._updateProperties(),null!=_caller.onprogress&&_caller.onprogress(e),_caller._fireEventListeners(_caller._onprogress,e))},_abort:function(e){null!=_caller&&void 0!==_caller._updateProperties&&(_caller._updateProperties(),null!=_caller.onabort&&_caller.onabort(e),_caller._fireEventListeners(_caller._onabort,e))},_timeout:function(e){null!=_caller&&void 0!==_caller._updateProperties&&(_caller._updateProperties(),null!=_caller.ontimeout&&_caller.ontimeout(e),_caller._fireEventListeners(_caller._ontimeout,e))},_uploadprogress:function(e){null!=_caller&&void 0!==_caller._updateProperties&&(_caller._updateProperties(),null!=_caller.onuploadprogress&&_caller.onuploadprogress(e),_caller._fireEventListeners(_caller._onuploadprogress,e))},_loadstart:function(e){null!=_caller&&void 0!==_caller._updateProperties&&(_caller._updateProperties(),null!=_caller.onloadstart&&_caller.onloadstart(e),_caller._fireEventListeners(_caller._onloadstart,e))},_fireEventListeners:function(e,r){if("object"==typeof e)for(var t in e){var o=e[t];try{o(r)}catch(e){}}},UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,abort:function(){this._refresh(),this._ajax.abort(),this._updateProperties()},getAllResponseHeaders:function(){return this._refresh(),this._updateProperties(),this._ajax.getAllResponseHeaders()},getResponseHeader:function(e){return this._refresh(),this._updateProperties(),this._ajax.getResponseHeader(e)},open:function(e,r,t,o,n){arguments.length<3&&(t=!0),this._reqUrl=r,r=this._EncodeAJAXUrl(e,r,o,n),e=this._ASProxyEncodeAJAXMethod(e),this._async=t,this._refresh(),this._ajax.open(e,r,t,o,n),this._updateProperties()},send:function(e){var r=this._EncodeArray(this._headers);this._ajax.setRequestHeader("X-ASProxy-AJAX-Headers",r),this._ajax.setRequestHeader("X-ASProxy-AJAX-Referrer",_reqInfo.pageUrl),e&&e.nodeType&&(e=window.XMLSerializer?(new window.XMLSerializer).serializeToString(e):e.xml,this._headers["Content-Type"]||this._ajax.setRequestHeader("Content-Type","application/xml")),this._refresh(),this._ajax.send(e),this._updateProperties()},sendAsBinary:function(e){var r=this._EncodeArray(this._headers);this._ajax.setRequestHeader("X-ASProxy-AJAX-Headers",r),this._ajax.setRequestHeader("X-ASProxy-AJAX-Referrer",_reqInfo.pageUrl),this._refresh(),this._ajax.sendAsBinary(e),this._updateProperties()},setRequestHeader:function(e,r){_ArrayAdd(this._headers,e,r),this._refresh(),this._ajax.setRequestHeader(e,r),this._updateProperties()},overrideMimeType:function(e){this._refresh(),this._ajax.overrideMimeType(e),this._updateProperties()},toString:function(){return"[XMLHttpRequest]"},addEventListener:function(e,r,t){var o="_on"+e,n=r.toString()+t.valueOf();null!=this[o]?(_ArrayAdd(this[o],n,r),this[o].push(function(){})):_ASProxy.AttachEvent(this._ajax,e,r,t)},removeEventListener:function(e,r,t){var o="_on"+e,n=r.toString()+t.valueOf(),a=this[o];null!=array?delete a[n]:_ASProxy.DetachEvent(this._ajax,e,r,t)},dispatchEvent:function(e){this._ajax.dispatchEvent(e)},readyState:0,responseText:"",responseXML:null,responseBody:0,status:0,statusText:"",channel:null,multipart:!1,onreadystatechange:null,onload:null,onerror:null,onprogress:null,onabort:null,ontimeout:null,onuploadprogress:null,onloadstart:null},!0),Object.extend(XMLHttpRequest.prototype,{_ASProxyEncodeAJAXMethod:function(e){return null==e?e:"post"==e.toLowerCase()?"POST":"GET"},_EncodeArray:function(e){var r="{";for(var t in e){var o=e[t];null!=o&&"function"!=typeof o&&(r+='"'+t+'"|#|"'+o+'"|^|')}return r+="}"},_ASProxyEncoderAJAXUrl:function(e,r,t,o){var n,a=r;if(_ASProxy.IsClientSideUrl(a)||_ASProxy.IsSelfBookmarkUrl(a))return a;if(_ASProxy.IsEncodedByASProxy(a)){var i=_ASProxy.GetUrlParamValue("ajaxurl",a)+"";""==i&&(i=_ASProxy.GetUrlParamValue("url",a)+""),""!=i&&(a=i=_userConfig.EncodeUrl?_Base64_decode(_ASProxy.B64UnknownerRemove(i)):unescape(i))}a=_ASProxy.CorrectLocalUrlToOrginal(a),_ASProxy.IsVirtualUrl(a)&&(a=_ASProxy.JoinUrls(a,_reqInfo.pageUrl,_reqInfo.pagePath,_reqInfo.rootUrl));var l=_ASProxy.Pages.pgAjax;return n=l+="?dec="+(_userConfig.EncodeUrl+0)+"&ajaxurl=",_userConfig.EncodeUrl?n+=_ASProxy.B64UnknownerAdd(_Base64_encode(a)):n+=escape(a),n+="&method="+e,null!=t&&(n+="&use="+_ASProxy.B64UnknownerAdd(_Base64_encode(t))),null!=o&&(n+="&pas="+_ASProxy.B64UnknownerAdd(_Base64_encode(o))),n},_EncodeAJAXUrl:function(e,r,t,o){return this._ASProxyEncoderAJAXUrl(e,r,t,o)}},!0),_ASProxyXMLHttpRequest&&_ASProxyXMLHttpRequest.wrapped&&(XMLHttpRequest.wrapped=_ASProxyXMLHttpRequest.wrapped),_ASProxy.StartupDynamicEncoders=function(){window.setTimeout("_ASProxy.Enc.EncodeLinks();",500),window.setTimeout("_ASProxy.Enc.EncodeImages();",700),window.setTimeout("_ASProxy.Enc.EncodeInputImages();",2e3),window.setTimeout("_ASProxy.Enc.EncodeForms();",1e3),window.setTimeout("_ASProxy.Enc.EncodeFrames();",2e3),window.setTimeout("_ASProxy.Enc.EncodeScriptSources();",4e3)},_ASProxy.Initialize=function(){_ASProxy.OverrideStandardsDeclare(),__XUrl=new _ASProxy.LocationObject,_ASProxy.ReqLocation=__XUrl,document.__XUrl=__XUrl,_ASProxy.OverrideStandards(),_ASProxy.OverrideHtmlSetters(),_ASProxy.DynamicEncoders&&_ASProxy.StartupDynamicEncoders()},0==_ASProxyLoaded&&_ASProxy.Initialize();